(function(lib_name,crystal_args,namespace,ua){if(typeof window[lib_name]!="undefined"){return}window[lib_name]=window.AD2=namespace;eval(namespace.output(lib_name));namespace.crystal_args=crystal_args;var refs=namespace.__images=[],sendImage=function(url){var img=new Image(1,1);img.src=url;refs.push(img);return this},report_ua=(function(){for(var i in ua){if(ua[i]!=0){return i+ua[i]}}})(),importScript=namespace.importScript=function(url,callback){var script=document.createElement("script");script.src=url;if(callback){if(ua.ie){script.onreadystatechange=function(){var rs=this.readyState;if("loaded"===rs||"complete"===rs){callback()}}}else{script.onload=callback}}document.getElementsByTagName("head")[0].appendChild(script)},channel_match=location.href.match(/(\w+)\.qq\.com/),channel=channel_match&&channel_match[1];var IPingBase={append:doNothing,flush:doNothing,touch:sendImage};var PageSpeedPing=(function(){if(Math.random()>crystal_args.mo_page_ratio){return IPingBase}var cutTime=function(num){var s=(num+"");return s.substring(s.length-6)};var stamps={ua:report_ua,domain:channel,QosS:cutTime((function(){if(typeof QosS=="undefined"){return 0}if(QosS.G){return QosS.G.startTime||Qoss.G.sT||0}if(QosS.Global){return QosS.Global.startTime||0}return 0})())};return mix(instance(IPingBase),{append:function(tag){stamps[tag]=cutTime((new Date()).getTime())},flush:function(){sendImage(crystal_args.mo_page_url+"?"+serializeQuery(stamps));this.flush=function(){}}})})();var buildMoPing=function(ratio,url,dic){if(Math.random()>ratio){return IPingBase}return{flush:function(){var begin_time=new Date();var check=function(key,is_success){dic[key]=is_success?(new Date()-begin_time):-1;for(var key in dic){if(typeof dic[key]!=="number"){return}}mix(dic,{ua:report_ua,domain:channel});sendImage(url+"?"+serializeQuery(dic))};each(dic,function(url,key){var img=new Image(1,1);img.onload=function(){check(key,true)};img.onerror=function(){check(key,false)};img.src=url+"?"+begin_time.getTime()})}}};var ServicePing=buildMoPing(crystal_args.mo_service_ratio,crystal_args.mo_service_url,{l:"http://l.qq.com/oms/speed.gif",p:"http://p.l.qq.com/oms/speed.gif",c:"http://c.l.qq.com/oms/speed.gif"});var FilePing=buildMoPing(crystal_args.mo_file_ratio,crystal_args.mo_file_url,{a:"http://adsfile.qq.com/web/expires_10_min/mo_1.swf",b:"http://adsfile.qq.com/web/expires_10_min/mo_5.swf",c:"http://adsfile.qq.com/web/expires_10_min/mo_10.swf",d:"http://adsfile.qq.com/web/expires_10_min/mo_20.swf"});var VisitorPing=namespace.ping=(function(){var query_strings=["oid","cid","loc"],cache={},clearCache=function(){each(query_strings,function(k){cache[k]=[]})},flush=function(){if(cache.oid.length){sendImage(format(crystal_args.ping_template,cache));clearCache()}},bufferFlush=buffer(flush,2000);clearCache();return mix(instance(IPingBase),{append:function(data){each(cache,function(v,k){v.push(data[k])});if(cache.oid.length==50){flush()}else{bufferFlush()}},flush:flush})})();(function(dom,evt,cookie){mix(namespace,{dom:dom,evt:evt,ua:ua,cookie:cookie});evt.on(window,"load",function(){setTimeout(function(){PageSpeedPing.flush();FilePing.flush();ServicePing.flush()},1000)});PageSpeedPing.append("js_loaded");evt.ready(function(){PageSpeedPing.append("page_loaded")});evt.on(window,"unload",function(){VisitorPing.flush()});namespace.resource=function(file){return crystal_args.file_path+file};var getExtension=namespace.getExtension=function(uri){try{return/\.(\w+)(?:$|\?)/.exec(uri)[1].toLowerCase()}catch(e){return"jpg"}},htmlEncode=(function(){var el=document.createElement("pre");return function(str){el.innerHTML="";el.appendChild(document.createTextNode(str));return el.innerHTML}})();namespace.getPlayIndex=function(){return parseInt(cookie.get("ad_play_index"))||Math.floor(Math.random()*100)};var display_index=namespace.getPlayIndex();cookie.set("ad_play_index",display_index+1,{expires:1,path:"/"});var queue=function(precondition){var preconditioned=false;var precondition_is_running=false;var fns=[];return function(fn){if(preconditioned){fn()}else{fns.push(fn);if(!precondition_is_running){precondition(function(){each(fns,function(f){f()});preconditioned=true});precondition_is_running=true}}}},afterImportExtension=queue(function(callback){if(crystal_args.is_debug){crystal_args.extension_js_src+="?_="+(new Date()).getTime()}importScript(crystal_args.extension_js_src,callback)}),NONE=namespace.NONE=1,IMMEDIATELY=namespace.IMMEDIATELY=2,LAZY=namespace.LAZY=3,default_fodder_count=3,default_index=Math.floor(Math.random()*10)%default_fodder_count,getDefaultFodderUrl=(function(){var scales=[{scale:7.15,size:"960x90"},{scale:2.4,size:"409x114"},{scale:0,size:"300x250"}];var getScale=function(width,height){if(height==0){height=1}var s=width/height;for(var i=0;i<scales.length;i++){if(s>=scales[i].scale){return scales[i].size}}};return function(width,height){return format("http://adsfile.qq.com/web/default_fodders/{scale}_{index}.swf",{scale:getScale(width,height),index:default_index++%default_fodder_count})}})(),getDefaultFodder=function(el){return{resource_url:getDefaultFodderUrl(el.offsetWidth,el.offsetHeight),width:el.offsetWidth,height:el.offsetHeight,cover:false}},dic_display={banner:{ping:LAZY,render:function(config,el){renderFodder(config.fodder[0],el)}},auto:{ping:LAZY,render:function(config,el){renderFodder(getDefaultFodder(el),el)}},"default":{ping:NONE,render:function(config,el){renderFodder(getDefaultFodder(el),el)}},"null":{ping:IMMEDIATELY,render:function(){}},banner_script_src:{ping:IMMEDIATELY,render:function(config,el){renderFodder(config.fodder[0],el);importScript(config.fodder[1].resource_url)}},banner_import_monitor_url:{ping:IMMEDIATELY,render:function(config,el){renderFodder(config.fodder[0],el);importScript(config.monitor_url)}}},display_buffer={},NO_AD={},request=namespace.request=(function(){var lazyRender;(function(){var event_attached=false,areas={},ping_effect_height=crystal_args.ping_effect_height,pre_load_offset=crystal_args.pre_load_offset,max_used_height=0;var _checkRender=function(force_recalculate){var used_height=dom.getDocumentScrollTop()+dom.getViewportHeight();if(!force_recalculate&&used_height<=max_used_height){return}max_used_height=used_height;var rendered_ids=[];each(areas,function(o,id){if(force_recalculate||!o.y){var xy=dom.getXY(o.el);o.y=xy[1]}if(o.y<=used_height+pre_load_offset){if(!o.rendered){o.render();o.rendered=true}}if(o.y<=used_height-ping_effect_height){if(!o.pinged){o.ping();o.pinged=true}}if(o.pinged&&o.rendered){rendered_ids.push(id)}});each(rendered_ids,function(id){delete areas[id]});var no_area=true;each(areas,function(){no_area=false});if(no_area){evt.un(window,"resize",checkRender);evt.un(window,"scroll",checkRender);event_attached=false}};var checkRender=function(){_checkRender(false)};namespace.forceCheckRender=function(){_checkRender(true)};var bufferCheckRender=buffer(function(){if(!event_attached){checkRender();evt.on(window,"resize",checkRender);evt.on(window,"scroll",checkRender);event_attached=true}},100);namespace.renderAll=function(){each(areas,function(o,id){if(!o.rendered){o.render();o.rendered=true}});areas={};evt.un(window,"resize",checkRender);evt.un(window,"scroll",checkRender);event_attached=false};lazyRender=function(id,render,ping){areas[id]={el:dom.$(id),render:render,rendered:false,ping:ping,pinged:false};bufferCheckRender()}})();var rendered_area={},in_reqeusting_ids={},renderArea=function(creativity_config,area_id,not_retry){var area=dom.$(area_id);if(!area){if(!not_retry){evt.ready(function(){renderArea(creativity_config,area_id,true)})}return}var render_type=0;area.setAttribute("oid",creativity_config.oid);area.setAttribute("display",creativity_config.display);if(area.getAttribute("immediately")){render_type=IMMEDIATELY}var display_handler=namespace.getDisplayHandler(creativity_config.display);var pingArea=function(){VisitorPing.append({loc:area_id,cid:creativity_config.cid,oid:creativity_config.oid});if(creativity_config.monitor_url){VisitorPing.touch(creativity_config.monitor_url)}};var render=function(){display_handler.render(creativity_config,area,area_id,pingArea)};var render_type=render_type||display_handler.ping;if(!crystal_args.lazy_render&&render_type==LAZY){render_type=IMMEDIATELY}switch(render_type){case IMMEDIATELY:render();pingArea();break;case LAZY:lazyRender(area_id,render,pingArea);break;case NONE:render();break;default:}},buildDefaultCreativityConfig=function(area_id){var el=dom.$(area_id);if(!el||dom.getStyle(el,"display")=="none"){return NO_AD}return{display:"default"}},renderBuffer=function(){each(arguments,function(area_id){if(!rendered_area[area_id]&&!display_buffer[area_id]){display_buffer[area_id]=buildDefaultCreativityConfig(area_id)}});each(display_buffer,function(creativity_config,area_id){if(rendered_area[area_id]){return}rendered_area[area_id]=true;if(creativity_config===NO_AD){return}var display=creativity_config.display;if(dic_display[display]){renderArea(creativity_config,area_id)}else{afterImportExtension(function(){renderArea(creativity_config,area_id)})}delete display_buffer[area_id]});PageSpeedPing.append("start_draw_areas")},isNewArea=function(area_id){if(!rendered_area[area_id]&&!display_buffer[area_id]&&!in_reqeusting_ids[area_id]){in_reqeusting_ids[area_id]=true;return true}},findAreas=namespace.findAreas=function(){PageSpeedPing.append("search_areas");var areas=map(dom.getElementsByClassName(crystal_args.area_class,crystal_args.element_tags),function(el){return el.id});PageSpeedPing.append("end_search_areas");return areas};return function(area1,area2,areaN){var no_data_area_ids=filter(typeof arguments[0]=="string"?arguments:findAreas(),isNewArea);if(no_data_area_ids.length){var callback=function(){PageSpeedPing.append("end_request_lview");clearTimeout(timeout_handle);renderBuffer.apply(window,no_data_area_ids);each(no_data_area_ids,function(area_id){delete in_reqeusting_ids[area_id]})};PageSpeedPing.append("request_lview");importScript(format(crystal_args.lview_template,{loc:no_data_area_ids.join(",")}),callback);var timeout_handle=setTimeout(callback,crystal_args.lview_time_out*1000)}renderBuffer()}})();if(crystal_args.execute_on_ready){evt.ready(request)}namespace.analyze=function(src){afterImportExtension(function(){importScript(src)})};namespace.render=function(){};namespace.area=function(area_config){var area_id=area_config.id;display_buffer[area_id]=NO_AD;return function(){if(arguments.length==0){return}var creativity_config=arguments[display_index%arguments.length];if(creativity_config.oid==1){creativity_config.display="null"}if(creativity_config.oid==100){creativity_config.display="auto"}var display=creativity_config.display;if(indexOf(["turner"],display)!=-1){creativity_config={display:display,data:arguments}}display_buffer[area_id]=creativity_config}};namespace.getDisplayHandler=function(id){return dic_display[id]};namespace.setDisplayHandler=function(o){mix(dic_display,o)};var DelayClass=Class.create({init:function(){this.invokes=[]},invoke:function(method,args){this.invokes.push(arguments)},set:function(o){this.invoke=function(method,args){return o[method].apply(o,args||[])};each(this.invokes,function(args){this.invoke(args[0],args[1])},this)}});(function(){var areas={};namespace.getArea=function(id){return areas[id]||(areas[id]=new DelayClass())};namespace.setArea=function(id,o){namespace.getArea(id).set(o)}})();var renderFodder=namespace.renderFodder=function(fodder,el){if(!el){return}if(fodder.width){dom.setStyle(el,{display:"block",width:fodder.width,height:fodder.height})}renderer[getExtension(fodder.resource_url)](fodder,el);if(dom.getStyle(el,"position")=="static"){el.style.position="relative"}if(fodder.cover){var cover=dom.createElement({position:"absolute",width:fodder.width+"px",height:fodder.height+"px",left:"0px",top:"0px",cursor:"pointer","z-index":10,"background-color":"#fff",filter:"alpha(opacity=0)",opacity:0},{"class":"absolute a_cover",href:htmlEncode(fodder.link_to),target:"_blank"},"a");el.appendChild(cover)}};var renderer=(function(){var param_template='<param name="{name}" value="{value}"></param>',buildParams=function(o){return map(o,function(v,k){return format(param_template,{name:k,value:v})}).join("")},removeFlash=function(flash){if(!flash||!flash.parentNode){return}if(ua.ie){for(var i in flash){if(typeof flash[i]=="function"){flash[i]=null}}}flash.parentNode.removeChild(flash)},buildHTML=dom.buildHTML,_renderImage=function(styles,link,el){el.innerHTML=buildHTML(styles,{href:htmlEncode(link),target:"_blank"},"a");return el.firstChild},renderImage=function(config,el){var styles={display:"block",cursor:"pointer",width:config.width+"px",height:config.height+"px","background-image":format("url({uri})",config.resource_url)};return _renderImage(styles,config.link_to,el)},renderIEPNG=function(config,el){var styles={display:"block",cursor:"pointer",width:config.width+"px",height:config.height+"px",filter:format("progid:DXImageTransform.Microsoft.AlphaImageLoader(src='{uri}')",config.resource_url)};return _renderImage(styles,config.link_to,el)},renderFlash=function(config,el){var params={allowscriptaccess:"always",wmode:"opaque",quality:"high"};if(config.params){mix(params,config.params)}var initvars=config.initvars||{};if(config.link_to){initvars.adlink=config.link_to}params.flashvars=serializeQuery(initvars);var attrs={id:generateId()};if(ua.ie){attrs.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";params.movie=config.resource_url}else{params.type="application/x-shockwave-flash";attrs.data=config.resource_url}el.innerHTML=buildHTML({outline:"none",width:config.width+"px",height:config.height+"px"},attrs,"object",buildParams(params));var flash=el.firstChild;evt.on(window,"unload",function(){removeFlash(flash)});return flash},renderSl=function(config,el){var params=mix({source:config.resource_url,windowless:true},config.params);var initvars=mix({adlink:config.link_to},config.initvars);params.initParams=serializeQuery(initvars);el.innerHTML=buildHTML({width:config.width+"px",height:config.height+"px"},{type:"application/x-silverlight",data:"data:application/x-silverlight,"},"object",buildParams(params));return el.firstChild};return{jpg:renderImage,png:ua.ie==6?renderIEPNG:renderImage,gif:renderImage,swf:renderFlash,xap:renderSl}})()})((function(){var el_template='<{tag} {attrs}style="{styles}">{inner}</{tag}>',propertyCache={},patterns={HYPHEN:/(-[a-z])/i,ROOT_TAG:/^body|html$/i},toCamel=function(property){if(!patterns.HYPHEN.test(property)){return property}if(propertyCache[property]){return propertyCache[property]}var converted=property;while(patterns.HYPHEN.exec(converted)){converted=converted.replace(RegExp.$1,RegExp.$1.substr(1).toUpperCase())}propertyCache[property]=converted;return converted},setStyle=(function(){var px=/left|top|right|bottom|width|height/;var transVal=function(k,v){if(px.test(k)&&typeof v=="number"){v=v+"px"}return v};if(ua.ie){return function(el,property,val){property=toCamel(property);switch(property){case"opacity":el.style.filter="alpha(opacity="+val*100+")";if(!el.currentStyle||!el.currentStyle.hasLayout){el.style.zoom=1}break;case"float":property="styleFloat";default:el.style[property]=transVal(property,val)}}}else{return function(el,property,val){property=toCamel(property);if(property=="float"){property="cssFloat"}el.style[property]=transVal(property,val)}}})(),buildHTML=function(styles,attrs,tag,inner){return format(el_template,{tag:tag||"div",attrs:serializeAttrs(attrs||{}),styles:serializeStyles(styles),inner:inner||""})},getStyle=(function(){if(document.defaultView&&document.defaultView.getComputedStyle){return function(el,property){var value=null;if(property=="float"){property="cssFloat"}var computed=document.defaultView.getComputedStyle(el,"");if(computed){value=computed[toCamel(property)]}return el.style[property]||value}}else{if(document.documentElement.currentStyle&&ua.ie){return function(el,property){switch(toCamel(property)){case"opacity":var val=100;try{val=el.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(e){try{val=el.filters("alpha").opacity}catch(e){}}return val/100;case"float":property="styleFloat";default:var value=el.currentStyle?el.currentStyle[property]:null;return(el.style[property]||value)}}}else{return function(el,property){return el.style[property]}}}})(),hasClass=function(elem,className){return elem&&indexOf((elem.className||elem).toString().split(/\s+/),className)>-1};return{hasClass:hasClass,$:function(id){if(typeof id=="string"){return document.getElementById(id)}return id},getStyle:getStyle,setStyle:function(el,k,v){el=el;if(typeof k=="object"){each(k,function(_v,_k){setStyle(el,_k,_v)})}else{setStyle(el,k,v)}},buildHTML:buildHTML,createElement:function(html){if(typeof html!="string"){html=buildHTML.apply(window,arguments)}var el=document.createElement("div");el.innerHTML=html;return el.firstChild},getElementsByClassName:function(cls,tags){if(document.getElementsByClassName){return document.getElementsByClassName(cls)}var els=[];each(tags,function(tag){els=filter(document.getElementsByTagName(tag),function(div){return hasClass(div,cls)}).concat(els)});return els},getXY:function(el){var pos=[el.offsetLeft,el.offsetTop];var parentNode=el.offsetParent;var accountForBody=(ua.webkit&&getStyle(el,"position")=="absolute"&&el.offsetParent==el.ownerDocument.body);if(parentNode!=el){while(parentNode){pos[0]+=parentNode.offsetLeft;pos[1]+=parentNode.offsetTop;if(!accountForBody&&ua.webkit&&getStyle(parentNode,"position")=="absolute"){accountForBody=true}parentNode=parentNode.offsetParent}}if(accountForBody){pos[0]-=el.ownerDocument.body.offsetLeft;pos[1]-=el.ownerDocument.body.offsetTop}parentNode=el.parentNode;while(parentNode.tagName&&!patterns.ROOT_TAG.test(parentNode.tagName)){if(getStyle(parentNode,"display").search(/^inline|table-row.*$/i)){pos[0]-=parentNode.scrollLeft;pos[1]-=parentNode.scrollTop}parentNode=parentNode.parentNode}return pos},getDocumentScrollLeft:function(doc){doc=doc||document;return Math.max(doc.documentElement.scrollLeft,doc.body.scrollLeft)},getDocumentScrollTop:function(doc){doc=doc||document;return Math.max(doc.documentElement.scrollTop,doc.body.scrollTop)},getDocumentHeight:function(){var scrollHeight=(document.compatMode!="CSS1Compat")?document.body.scrollHeight:document.documentElement.scrollHeight;var h=Math.max(scrollHeight,this.getViewportHeight());return h},getDocumentWidth:function(){var scrollWidth=(document.compatMode!="CSS1Compat")?document.body.scrollWidth:document.documentElement.scrollWidth;var w=Math.max(scrollWidth,this.getViewportWidth());return w},getViewportHeight:function(){var height=self.innerHeight;var mode=document.compatMode;if((mode||ua.ie)&&!ua.opera){height=(mode=="CSS1Compat")?document.documentElement.clientHeight:document.body.clientHeight}return height},getViewportWidth:function(){var width=self.innerWidth;var mode=document.compatMode;if(mode||ua.ie){width=(mode=="CSS1Compat")?document.documentElement.clientWidth:document.body.clientWidth}return width}}})(),(function(){var evt={};if(document.addEventListener){evt.on=function(el,type,handler){el.addEventListener(type,handler,false);return handler};evt.on2=evt.on;evt.un=function(el,type,handler){el.removeEventListener(type,handler,false)};evt.stopPropagation=function(e){e.stopPropagation()};evt.preventDefault=function(e){e.preventDefault()};evt.getTarget=function(e){return e.target}}else{evt.on=function(el,type,handler){el.attachEvent("on"+type,handler)};evt.on2=function(el,type,handler){var actualHandler=function(){handler.call(el,window.event)};el.attachEvent("on"+type,actualHandler);return actualHandler};evt.un=function(el,type,handler){el.detachEvent("on"+type,handler)};evt.stopPropagation=function(e){e.cancelBubble=true};evt.preventDefault=function(e){e.returnValue=false};evt.getTarget=function(e){return e.srcElement}}evt.stop=function(e){evt.stopPropagation(e);evt.preventDefault(e)};(function(){var fns=[];var is_ready=false;evt.ready=function(f){fns.push(f)};var _ready=function(){if(!is_ready){is_ready=true;evt.ready=function(f){f()};each(fns,function(f){f()})}};if(ua.ie){var timer=setInterval(function(){try{document.doScroll();clearInterval(timer);timer=null;_ready()}catch(ex){}},64);document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);_ready()}})}else{evt.on(document,"DOMContentLoaded",_ready)}evt.on(window,"load",_ready)})();return evt})(),{set:function(key,value,options){var text=key+"="+value;if(options){if(options.expires){text+="; expires="+(new Date((new Date()).getTime()+86400000*options.expires)).toGMTString()}if(options.path){text+="; path="+options.path}if(options.domain){text+="; domain="+options.domain}if(options.secure===true){text+="; secure"}}document.cookie=text},get:function(key){var o=deserializeString("=","; ",false,false)(document.cookie);return key?o[key]:o},remove:function(k,options){options=options||{};options.expires=-1;this.set(k,"",options)}})})("crystal",(function(){var crystal_args={area_class:"l_qq_com",element_tags:["div"],execute_on_ready:true,file_path:"http://adsfile.qq.com/web/",is_debug:false,lazy_render:false,lview_template:"http://l.qq.com/lview?c=www&loc={loc}",lview_time_out:6,ping_template:"http://p.l.qq.com/p?oid={oid}&cid={cid}&loc={loc}",ping_effect_height:-99999,pre_load_offset:100,mo_page_ratio:0,mo_page_url:"http://dp3.qq.com/web/",mo_service_ratio:0,mo_service_url:"http://dp3.qq.com/core/",mo_file_ratio:0,mo_file_url:"http://dp3.qq.com/domain/"};crystal_args.extension_js_src=crystal_args.file_path+"crystal/lastest/crystal_ext-min.js";var script=document.getElementById("l_qq_com");try{var input_args=eval("("+script.getAttribute("arguments")+")");for(var i in input_args){crystal_args[i]=input_args[i]}}catch(e){}return crystal_args})(),(function(){var f=Array.slice||(function(){var g=Array.prototype.slice;return function(h){return g.apply(h,g.call(arguments,1))}})(),b=function(l){if(!l){l={}}for(var h=1;h<arguments.length;h++){var k=arguments[h];if(k){for(var g in k){l[g]=k[g]}}}return l},e=function(l,k,j){if(typeof l.length=="number"){for(var h=0,g=l.length;h<g;h++){k.call(j,l[h],h)}}else{if(typeof l=="number"){for(var h=0;h<l;h++){k.call(j,h,h)}}else{for(var h in l){if(l.hasOwnProperty(h)){k.call(j,l[h],h)}}}}},d=function(k,i,h,g){var j=g?encodeURIComponent:function(l){return l};return function(m){var l=[];e(m,function(o,n){if(n!=null&&o!=undefined){l.push(j(n)+k+j(o))}});return l.join(i)+(h?i:"")}},c=function(k,i,g,h){var j=h?decodeURIComponent:function(l){return l};return function(m){var l={};if(g){m=m.replace(new RegExp(i+"$"),"")}e(m.split(i),function(o){var n=o.split(k);l[j(n[0])]=j(n[1])});return l}},a={create:function(j,k){var i=function(){if(this.init){this.init.apply(this,arguments)}};var l=1;if(k&&typeof k=="function"){var h=function(){};i.superclass=h.prototype=k.prototype;i.prototype=new h();l=2}var g=f(arguments,l);g.unshift(j);b(i.prototype,b.apply(window,g));return i}};return{slice:f,generateId:(function(){var g=1;return function(){return"auto_gen_"+g++}})(),each:e,map:function(i,h){var g=[];e(i,function(l,j){g.push(h(l,j))});return g},filter:function(i,h){var g=[];e(i,function(l,j){if(h(l,j)===true){g.push(l)}});return g},indexOf:function(g,j){if(g.indexOf){return g.indexOf(j)}for(var h=0;h<g.length;h++){if(g[h]===j){return h}}return -1},mix:b,serializeDictionary:d,deserializeString:c,serializeStyles:d(":",";",true,false),serializeAttrs:(function(){var g=d("="," ",true,false);return function(h){e(h,function(j,i){h[i]='"'+j+'"'});return g(h)}})(),serializeQuery:d("=","&",false,true),buffer:function(h,g){var i;return function(){if(i){clearTimeout(i)}var j=arguments;i=setTimeout(function(){h.apply(window,j)},g||100)}},format:function(i,h,g){return i.replace(/\{([^}]*)\}/g,(typeof h=="object")?function(j,l){var k=h[l];return k==null&&g?j:k}:h)},instance:function(h){var g=function(){};g.prototype=h;return new g()},doNothing:function(){},output:function(h,j){var g=[];h=h||"crystal";for(var i in (j||this)){g.push("var ",i,"=",h,".",i,";")}return g.join("")},Class:a}})(),(function(){var c={ie:0,opera:0,gecko:0,webkit:0,mobile:null};var b=navigator.userAgent,a;if((/KHTML/).test(b)){c.webkit=1}a=b.match(/AppleWebKit\/([^\s]*)/);if(a&&a[1]){c.webkit=parseFloat(a[1]);if(/ Mobile\//.test(b)){c.mobile="Apple"}else{a=b.match(/NokiaN[^\/]*/);if(a){c.mobile=a[0]}}}if(!c.webkit){a=b.match(/Opera[\s\/]([^\s]*)/);if(a&&a[1]){c.opera=parseFloat(a[1]);a=b.match(/Opera Mini[^;]*/);if(a){c.mobile=a[0]}}else{a=b.match(/MSIE\s([^;]*)/);if(a&&a[1]){c.ie=parseFloat(a[1])}else{a=b.match(/Gecko\/([^\s]*)/);if(a){c.gecko=1;a=b.match(/rv:([^\s\)]*)/);if(a&&a[1]){c.gecko=parseFloat(a[1])}}}}}return c})());var mutex_lock,mutex_unlock;(function(b){var a=false;b.mutex_lock=function(){if(a){return -1}else{a=true;return 0}};b.mutex_unlock=function(){a=false;return 0}})(window);
